(function(){"use strict";var t={5364:function(t,e,a){var n=a(9242),s=a(3396);const o={class:"main"},r={class:"main__container"};function i(t,e,a,n,i,d){const c=(0,s.up)("FormAdd"),l=(0,s.up)("OrdersPlot"),u=(0,s.up)("TargoHeader"),m=(0,s.up)("CardsContainer"),p=(0,s.up)("TargoFooter");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(c),(0,s.Wm)(l,{ref:"ordersPlot"},null,512),(0,s.Wm)(u),(0,s._)("main",o,[(0,s._)("div",r,[(0,s.Wm)(m,{onCardClick:d.cardClick},null,8,["onCardClick"])])]),(0,s.Wm)(p)],64)}var d=a(4870);const c={class:"form-add"},l=(0,s.uE)('<h2 class="add__title" data-v-ef3da3fa> Добавить товар </h2><div class="add__img" data-v-ef3da3fa><input class="add__input" type="file" accept="image/*" name="img" data-v-ef3da3fa></div><div class="add__name" data-v-ef3da3fa><label data-v-ef3da3fa><h3 class="add-subtitle" data-v-ef3da3fa>Название</h3><input class="add__input" type="text" name="name" data-v-ef3da3fa></label></div><div class="add__price" data-v-ef3da3fa><label data-v-ef3da3fa><h3 class="add-subtitle" data-v-ef3da3fa>Цена</h3><input class="add__input" name="price" type="number" min="1" data-v-ef3da3fa></label></div><div class="add__description" data-v-ef3da3fa><label data-v-ef3da3fa><h3 class="add-subtitle" data-v-ef3da3fa>Описание</h3><textarea name="description" class="add__input" data-v-ef3da3fa></textarea></label></div><div class="add__button" data-v-ef3da3fa><button class="btn" data-v-ef3da3fa> Добавить </button></div>',6),u=[l];function m(t,e,a,o,r,i){return(0,s.wy)(((0,s.wg)(),(0,s.iD)("section",c,[(0,s._)("form",{name:"product-add",class:"form-add__add add",enctype:"multipart/form-data",onSubmit:e[0]||(e[0]=(...t)=>i.addProduct&&i.addProduct(...t))},u,32)],512)),[[n.F8,o.showAddForm]])}a(560);const p={name:"FormAdd",setup(){const t=(0,s.f3)("theme"),e=(0,s.f3)("products"),a=(0,s.f3)("showAddForm"),n=(0,s.f3)("themeAlpha");return{theme:t,products:e,showAddForm:a,themeAlpha:n}},data(){return{id:0}},mounted(){this.id=this.products.length},methods:{async addProduct(t){t.preventDefault();const e=document.querySelector(".form-add__add"),a=new FormData(e);e.reset();await fetch("/",{method:"post",body:a});const n=new Date;n.setHours(n.getTimezoneOffset()/-60,0,0,0);try{setTimeout((()=>{this.products.push({imgName:a.get("img").name,name:a.get("name"),price:+a.get("price"),description:a.get("description"),orders:[{date:n,n:1}],id:this.id}),this.id+=1}),2e3)}catch{alert("Не удалось добавить товар. Попробуйте снова")}}}},h=()=>{(0,n.sj)((t=>({"12e8452a":t.themeAlpha(),"3a0b7ad4":t.theme})))},_=p.setup;p.setup=_?(t,e)=>(h(),_(t,e)):h;var f=p,v=a(89);const g=(0,v.Z)(f,[["render",m],["__scopeId","data-v-ef3da3fa"]]);var b=g;const w=t=>((0,s.dD)("data-v-60135823"),t=t(),(0,s.Cn)(),t),y={class:"plot__container"},C={class:"plot__body"},I={class:"plot__item"},x={class:"plot__item"},k=w((()=>(0,s._)("div",{class:"plot__content"},null,-1)));function T(t,e,a,n,o,r){return(0,s.wg)(),(0,s.iD)("section",{class:"plot",onClick:e[3]||(e[3]=(...t)=>r.closePopup&&r.closePopup(...t))},[(0,s._)("div",y,[(0,s._)("div",C,[(0,s._)("div",{class:"plot__items",onClick:e[2]||(e[2]=t=>t.stopPropagation())},[(0,s._)("div",I,[(0,s._)("input",{class:"plot__input_min",type:"date",onChange:e[0]||(e[0]=(...t)=>r.minChange&&r.minChange(...t))},null,32)]),(0,s._)("div",x,[(0,s._)("input",{class:"plot__input_max",type:"date",onChange:e[1]||(e[1]=(...t)=>r.maxChange&&r.maxChange(...t))},null,32)])]),k])])])}var S=a(8302),P=a.n(S);const F={name:"OrdersPlot",setup(){const t=(0,s.f3)("theme"),e=(0,s.f3)("themeAlpha");return{theme:t,themeAlpha:e}},data(){return{minI:0,maxI:0,orders:[],plotContent:null,minInput:null,maxInput:null}},mounted(){this.plotContent=document.querySelector(".plot__content"),this.minInput=document.querySelector(".plot__input_min"),this.maxInput=document.querySelector(".plot__input_max");const t={title:{text:"Количество заказов",font:{color:"#000"}},xaxis:{title:{text:"Даты",font:{color:"#000"}}},yaxis:{title:{text:"Количество",font:{color:"#000"}}}};P().newPlot(this.plotContent,[{}],t,{staticPlot:!0,responsive:!0})},methods:{cardClick(t){this.maxI=t.length-1,this.minInput.value=t[0].date.toISOString().slice(0,-14),this.maxInput.value=t.at(-1).date.toISOString().slice(0,-14),this.minInput.min=t[0].date.toISOString().slice(0,-14),this.minInput.max=this.maxInput.value,this.maxInput.min=this.minInput.value,this.maxInput.max=t.at(-1).date.toISOString().slice(0,-14),P().deleteTraces(this.plotContent,0),P().addTraces(this.plotContent,{x:t.slice(this.minI,this.maxI+1).map((t=>t.date.toLocaleString("ru").slice(0,-10))),y:t.slice(this.minI,this.maxI+1).map((t=>t.n)),mode:"lines+markers",name:"test1",line:{color:this.theme}}),this.orders=t},closePopup(){document.querySelector(".plot").classList.remove("_open"),document.body.classList.remove("_lock")},minChange(t){this.maxInput.min=t.target.value;const e=new Date(t.target.value);for(let a=0;a<=this.maxI;a++)if(this.orders[a].date>=e){this.minI=a;break}P().deleteTraces(this.plotContent,0),P().addTraces(this.plotContent,{x:this.orders.slice(this.minI,this.maxI+1).map((t=>t.date.toLocaleString("ru").slice(0,-10))),y:this.orders.slice(this.minI,this.maxI+1).map((t=>t.n)),mode:"lines+markers",name:"test1",line:{color:this.theme}})},maxChange(t){this.minInput.max=t.target.value;const e=new Date(t.target.value);for(let a=this.orders.length-1;a>=this.minI;a--)if(this.orders[a].date<=e){this.maxI=a;break}P().deleteTraces(this.plotContent,0),P().addTraces(this.plotContent,{x:this.orders.slice(this.minI,this.maxI+1).map((t=>t.date.toLocaleString("ru").slice(0,-10))),y:this.orders.slice(this.minI,this.maxI+1).map((t=>t.n)),mode:"lines+markers",name:"test1",line:{color:this.theme}})},changeFormat(t,e=".",a="-"){return t.split(e).reverse().join(a)}}},O=()=>{(0,n.sj)((t=>({"53dc724c":t.themeAlpha()})))},A=F.setup;F.setup=A?(t,e)=>(O(),A(t,e)):O;var D=F;const j=(0,v.Z)(D,[["render",T],["__scopeId","data-v-60135823"]]);var q=j;const J=t=>((0,s.dD)("data-v-53a94502"),t=t(),(0,s.Cn)(),t),H={class:"header"},L={class:"header__container"},N=J((()=>(0,s._)("div",{class:"header__logo"}," Targo ",-1))),Z={class:"header__themes themes"};function z(t,e,a,n,o,r){const i=(0,s.up)("BtnAdd");return(0,s.wg)(),(0,s.iD)("section",H,[(0,s._)("div",L,[N,(0,s._)("div",Z,[(0,s._)("button",{class:"themes__button _selected",onClick:e[0]||(e[0]=(...t)=>r.switchTheme&&r.switchTheme(...t))}),(0,s._)("button",{class:"themes__button themes_purple",onClick:e[1]||(e[1]=(...t)=>r.switchTheme&&r.switchTheme(...t))}),(0,s._)("button",{class:"themes__button themes_banana",onClick:e[2]||(e[2]=(...t)=>r.switchTheme&&r.switchTheme(...t))}),(0,s._)("button",{class:"themes__button themes_cyan",onClick:e[3]||(e[3]=(...t)=>r.switchTheme&&r.switchTheme(...t))}),(0,s._)("button",{class:"themes__button themes_lavender",onClick:e[4]||(e[4]=(...t)=>r.switchTheme&&r.switchTheme(...t))})]),(0,s.Wm)(i)])])}const W={class:"add"};function $(t,e,a,n,o,r){return(0,s.wg)(),(0,s.iD)("div",W,[(0,s._)("button",{onClick:e[0]||(e[0]=(...t)=>r.showForm&&r.showForm(...t))}," + ")])}var B={name:"BtnAdd",setup(){const t=(0,s.f3)("toggleForm");return{toggleForm:t}},methods:{showForm(){this.toggleForm(),document.body.classList.toggle("_lock")}}};const Y=(0,v.Z)(B,[["render",$],["__scopeId","data-v-4f9c44bc"]]);var E=Y;const K={name:"TargoHeader",components:{BtnAdd:E},setup(){const t=(0,s.f3)("theme");return{theme:t}},methods:{switchTheme(t){document.querySelector(".themes__button._selected").classList.remove("_selected"),this.theme=window.getComputedStyle(t.target).backgroundColor,t.target.classList.add("_selected")}}},M=()=>{(0,n.sj)((t=>({"0e61fe4c":t.theme})))},G=K.setup;K.setup=G?(t,e)=>(M(),G(t,e)):M;var Q=K;const R=(0,v.Z)(Q,[["render",z],["__scopeId","data-v-53a94502"]]);var U=R;const V={class:"products"};function X(t,e,a,n,o,r){const i=(0,s.up)("ProductCard");return(0,s.wg)(),(0,s.iD)("section",V,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.products,(t=>((0,s.wg)(),(0,s.j4)(i,{key:t.id,"img-name":t.imgName,name:t.name,price:t.price,description:t.description,orders:t.orders},null,8,["img-name","name","price","description","orders"])))),128))])}var tt=a(7139);const et={class:"card__img"},at=["src"],nt={class:"card__name"},st={class:"card__price"},ot={class:"card__description"},rt={class:"card__buttons"};function it(t,e,a,n,o,r){return(0,s.wg)(),(0,s.iD)("div",{class:"card",onClick:e[2]||(e[2]=(...t)=>r.showPlot&&r.showPlot(...t))},[(0,s._)("div",et,[(0,s._)("img",{src:`../../img/${a.imgName}`,alt:"Product"},null,8,at)]),(0,s._)("h3",nt,(0,tt.zw)(a.name),1),(0,s._)("div",st,(0,tt.zw)(`${a.price.toLocaleString("ru")} ₽`),1),(0,s._)("div",ot,(0,tt.zw)(a.description),1),(0,s._)("div",rt,[(0,s._)("button",{class:"card__button",onClick:e[0]||(e[0]=(...t)=>r.order&&r.order(...t))}," Заказать "),(0,s._)("button",{class:"card__button card__button_red",onClick:e[1]||(e[1]=(...t)=>r.del&&r.del(...t))}," Удалить ")])])}const dt={name:"TargoHeader",props:{imgName:{type:String,default:"404.webp",require:!0},name:{type:String,default:"Без имени",require:!0},price:{type:Number,default:0,require:!0},description:{type:String,default:"Описание отсутствует",require:!0},orders:{type:Array,default:null,require:!0}},emits:["cardClick"],setup(){const t=(0,s.f3)("theme"),e=(0,s.f3)("products"),a=(0,s.FN)().vnode.key;return{theme:t,products:e,key:a}},methods:{showPlot(){this.$parent.$emit("cardClick",this.orders),document.querySelector(".plot").classList.add("_open"),document.body.classList.add("_lock")},async order(t){t.stopPropagation();const e=this.products.findIndex((t=>t.id===this.key)),a=new Date;a.setHours(a.getTimezoneOffset()/-60,0,0,0),this.products[e].orders.at(-1).date<a?this.products[e].orders.push({date:a,n:1}):this.products[e].orders.at(-1).n+=1;await fetch("/order",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:e,now:a.toISOString().slice(0,-14)})})},async del(t){t.stopPropagation();const e=this.products.findIndex((t=>t.id===this.key));this.products.splice(e,1);await fetch("/del",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:e})})}}},ct=()=>{(0,n.sj)((t=>({bf12e4be:t.theme})))},lt=dt.setup;dt.setup=lt?(t,e)=>(ct(),lt(t,e)):ct;var ut=dt;const mt=(0,v.Z)(ut,[["render",it],["__scopeId","data-v-17081654"]]);var pt=mt,ht={name:"CardsContainer",components:{ProductCard:pt},setup(){const t=(0,s.f3)("theme"),e=(0,s.f3)("products");return{theme:t,products:e}},mounted(){fetch("/products").then((t=>t.json())).then((t=>{for(let e=0;e<t.length;e++){t[e].id=e;for(const a of t[e].orders)a.date=new Date(a.date)}this.products=t}))}};const _t=(0,v.Z)(ht,[["render",X],["__scopeId","data-v-fa940574"]]);var ft=_t;const vt={class:"footer"},gt={class:"footer__container"};function bt(t,e,a,n,o,r){return(0,s.wg)(),(0,s.iD)("section",vt,[(0,s._)("div",gt," Все права защищены © "+(0,tt.zw)((new Date).getFullYear()),1)])}const wt={name:"TargoFooter",setup(){const t=(0,s.f3)("theme");return{theme:t}}},yt=()=>{(0,n.sj)((t=>({f4f8d3ea:t.theme})))},Ct=wt.setup;wt.setup=Ct?(t,e)=>(yt(),Ct(t,e)):yt;var It=wt;const xt=(0,v.Z)(It,[["render",bt],["__scopeId","data-v-863ccaea"]]);var kt=xt;const Tt={name:"App",components:{FormAdd:b,OrdersPlot:q,TargoHeader:U,CardsContainer:ft,TargoFooter:kt},setup(){const t=(0,d.iH)("rgb(245, 245, 220)"),e=(0,d.iH)(!1),a=(0,d.iH)([]),n=()=>`rgba${t.value.slice(3,-1)}, 0.5)`,o=()=>e.value=!e.value;return(0,s.JJ)("theme",t),(0,s.JJ)("showAddForm",e),(0,s.JJ)("products",a),(0,s.JJ)("themeAlpha",n),(0,s.JJ)("toggleForm",o),{theme:t,products:a,themeAlpha:n}},methods:{cardClick(t){this.$refs.ordersPlot.cardClick(t)}}},St=()=>{(0,n.sj)((t=>({c3657278:t.theme})))},Pt=Tt.setup;Tt.setup=Pt?(t,e)=>(St(),Pt(t,e)):St;var Ft=Tt;const Ot=(0,v.Z)(Ft,[["render",i]]);var At=Ot;const Dt=(0,n.ri)(At);Dt.mount("#app")}},e={};function a(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,a),o.exports}a.m=t,function(){var t=[];a.O=function(e,n,s,o){if(!n){var r=1/0;for(l=0;l<t.length;l++){n=t[l][0],s=t[l][1],o=t[l][2];for(var i=!0,d=0;d<n.length;d++)(!1&o||r>=o)&&Object.keys(a.O).every((function(t){return a.O[t](n[d])}))?n.splice(d--,1):(i=!1,o<r&&(r=o));if(i){t.splice(l--,1);var c=s();void 0!==c&&(e=c)}}return e}o=o||0;for(var l=t.length;l>0&&t[l-1][2]>o;l--)t[l]=t[l-1];t[l]=[n,s,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,n){var s,o,r=n[0],i=n[1],d=n[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(d)var l=d(a)}for(e&&e(n);c<r.length;c++)o=r[c],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(l)},n=self["webpackChunktargo"]=self["webpackChunktargo"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(5364)}));n=a.O(n)})();
//# sourceMappingURL=app.b24789bb.js.map